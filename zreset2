Ch√†o b·∫°n,
T√¥i ƒë√£ t·ªïng h·ª£p to√†n b·ªô c√°c y√™u c·∫ßu v√† ch·ªânh s·ª≠a m·ªõi nh·∫•t c·ªßa b·∫°n v√†o m·ªôt k·ªãch b·∫£n Python ho√†n ch·ªânh.
C√°c thay ƒë·ªïi ƒë√£ ƒë∆∞·ª£c √°p d·ª•ng:
 * Disk Check L·∫ßn Cu·ªëi: ƒê√£ ch√®n logic ch·ªù 10 gi√¢y v√† ki·ªÉm tra % Disk Time m·ªôt l·∫ßn cu·ªëi sau khi v√≤ng l·∫∑p ki·ªÉm tra ƒëƒ©a ch√≠nh ho√†n th√†nh, tr∆∞·ªõc khi ƒë√≥ng ·ª©ng d·ª•ng Backup.
 * C·∫≠p nh·∫≠t INITIAL_COUNTDOWN_SECONDS: ƒê√£ ƒë·ªãnh nghƒ©a bi·∫øn n√†y trong ph·∫ßn c·∫•u h√¨nh.
 * C·∫≠p nh·∫≠t EmuRB:
   * ƒê√£ s·ª≠ d·ª•ng to√†n b·ªô chu·ªói click/nh·∫≠p ph√≠m v√† th·ªùi gian ch·ªù m·ªõi nh·∫•t b·∫°n cung c·∫•p, bao g·ªìm c√°c c√∫ click k√©p v√† c√°c c√∫ click m·ªõi ƒë·ªÉ l·∫•y ti√™u ƒëi·ªÉm (focus) c·ª≠a s·ªï EmuRB.
 * C·∫≠p nh·∫≠t LDPlayer Final Click: ƒê√£ th√™m t·ªça ƒë·ªô (1236, 272) v√†o chu·ªói click cu·ªëi c√πng.
üêç K·ªãch b·∫£n Python Ho√†n Ch·ªânh (ƒê√£ c·∫≠p nh·∫≠t)
import os
import time
import subprocess
import pyautogui
import re
# Kh√¥ng c·∫ßn import pygetwindow v√¨ b·∫°n ƒë√£ chuy·ªÉn sang d√πng click t·ªça ƒë·ªô ƒë·ªÉ l·∫•y focus

# ==============================================================================
# 1. C·∫§U H√åNH CHUNG
# ==============================================================================
# --- C·∫§U H√åNH LDPlayer & ·ª®ng d·ª•ng ---
LDPLAYER_MULTIPLAYER_PATH = r"C:\LDPlayer\LDPlayer9\dnmultiplayer.exe"
BACKUP_APP_PATH = r"C:\Users\ADMIN\Desktop\backupldplayer.exe"

# --- PERFORMANCE COUNTER v√† DELAY ---
DISK_ACTIVITY_COUNTER = r'\LogicalDisk(C:)\% Disk Time'
DISK_ACTIVITY_THRESHOLD = 5.0 # Ng∆∞·ª°ng Disk Time
STARTUP_DELAY_AFTER_BACKUP = 10 # Ch·ªù 10s sau khi ch·∫°y Backup
MAX_WAIT_TIME_DISK_CHECK = 3600 # Th·ªùi gian ch·ªù t·ªëi ƒëa 1 gi·ªù

# --- C·∫§U H√åNH EMURB ---
EMURB_PATH = r"C:\Users\ADMIN\Downloads\Yummyemu\YummyEmuPlayer\EmuRB.exe" 
# Bi·∫øn n√†y ƒë∆∞·ª£c y√™u c·∫ßu d√πng t·ª´ b√™n ngo√†i, nh∆∞ng ph·∫£i ƒë·ªãnh nghƒ©a ƒë·ªÉ script ho·∫°t ƒë·ªông ƒë·ªôc l·∫≠p:
INITIAL_COUNTDOWN_SECONDS = 3 

# ==============================================================================
# 2. CH·ª®C NƒÇNG H·ªñ TR·ª¢ CHUNG
# ==============================================================================
def kill_dnplayer():
    """ƒê√≥ng t·∫•t c·∫£ ti·∫øn tr√¨nh dnplayer.exe ƒëang ch·∫°y."""
    try:
        subprocess.run(
            ["taskkill", "/IM", "dnplayer.exe", "/F"],
            check=True,
            stdout=subprocess.DEVNULL,
            stderr=subprocess.STDOUT,
        )
        print("‚úÖ ƒê√£ ƒë√≥ng t·∫•t c·∫£ ti·∫øn tr√¨nh dnplayer.exe (LDPlayer).")
    except subprocess.CalledProcessError:
        print("‚ÑπÔ∏è Kh√¥ng t√¨m th·∫•y ti·∫øn tr√¨nh dnplayer.exe ƒëang ch·∫°y.")
    except Exception as e:
        print(f"‚ùå L·ªói khi ƒë√≥ng dnplayer.exe: {e}")

def get_performance_counter_value(counter_path):
    """ƒê·ªçc gi√° tr·ªã % Disk Time t·ª´ Performance Counter."""
    cmd = ["typeperf", counter_path, "-sc", "1"]
    try:
        result = subprocess.run(
            cmd, capture_output=True, text=True, encoding="utf-8", errors="ignore", timeout=15 
        )
    except subprocess.TimeoutExpired:
        return None
    
    lines = [line.strip() for line in result.stdout.splitlines() if line.strip()]
    for line in lines:
        m = re.search(r'"(-?\d+\.\d+)"', line)
        if m:
            try:
                return float(m.group(1))
            except ValueError:
                pass
    return None

def open_application(app_path): 
    """M·ªü ·ª©ng d·ª•ng v√† tr·∫£ v·ªÅ True/False."""
    if not os.path.isfile(app_path):
        print(f"‚ùå L·ªñI: Kh√¥ng t√¨m th·∫•y file ·ª©ng d·ª•ng t·∫°i: {app_path}") 
        return False
    
    subprocess.Popen([app_path], cwd=os.path.dirname(app_path))
    return True

# ==============================================================================
# 3. CHU·ªñI T·ª∞ ƒê·ªòNG H√ìA CH√çNH (LDPlayer & Backup)
# ==============================================================================

def run_automation_sequence():
    
    # --- PH·∫¶N 1: ƒê√ìNG LDPLAYER & M·ªû MULTIPLAYER ---
    print("\n[B∆Ø·ªöC 0] ƒê√≥ng c√°c c·ª≠a s·ªï LDPlayer ƒëang ho·∫°t ƒë·ªông...")
    kill_dnplayer()
    time.sleep(3) 

    # M·ªü LDMultiplayer l·∫ßn ƒë·∫ßu
    try:
        print(f"M·ªü ·ª©ng d·ª•ng LDMultiplayer: {LDPLAYER_MULTIPLAYER_PATH}")
        subprocess.Popen(LDPLAYER_MULTIPLAYER_PATH)
        time.sleep(5) # Ch·ªù ·ª©ng d·ª•ng load
    except FileNotFoundError:
        print(f"L·ªñI: Kh√¥ng t√¨m th·∫•y ƒë∆∞·ªùng d·∫´n ·ª©ng d·ª•ng: {LDPLAYER_MULTIPLAYER_PATH}")
        return 

    # CH√àN 4 C√ö CLICK M·ªöI
    CLICK_SEQUENCE_NEW_INSERT = [
        (652, 749), (786, 750), (822, 719), (891, 602)
    ]
    print("\n[PH·∫¶N CH√àN] Th·ª±c hi·ªán 4 click m·ªõi sau khi m·ªü LDMultiplayer...")
    for i, (x, y) in enumerate(CLICK_SEQUENCE_NEW_INSERT):
        print(f"Click ch√®n {i+1}: ({x}, {y})")
        pyautogui.click(x, y)
        time.sleep(1) 
    
    # Click theo t·ªça ƒë·ªô c≈© (chu·∫©n b·ªã sao l∆∞u)
    CLICK_SEQUENCE_OLD = [(779, 744), (824, 569)]
    print("\n[PH·∫¶N C≈®] Th·ª±c hi·ªán 2 click chu·∫©n b·ªã sao l∆∞u...")
    for i, (x, y) in enumerate(CLICK_SEQUENCE_OLD):
        print(f"Click chu·∫©n b·ªã sao l∆∞u {i+1}: ({x}, {y})")
        pyautogui.click(x, y)
        time.sleep(1) 

    print("Ch·ªù 6 gi√¢y tr∆∞·ªõc khi ch·∫°y Backup...")
    time.sleep(6)
    
    # --- PH·∫¶N 2: CH·∫†Y BACKUP & KI·ªÇM TRA ƒêƒ®A ---
    backup_process = None
    try:
        print(f"Ch·∫°y ·ª©ng d·ª•ng Backup: {BACKUP_APP_PATH}")
        backup_process = subprocess.Popen(BACKUP_APP_PATH) 
        
        print(f"*** Ch·ªù {STARTUP_DELAY_AFTER_BACKUP} gi√¢y ƒë·ªÉ Backup kh·ªüi ƒë·ªông v√† b·∫Øt ƒë·∫ßu ghi ƒëƒ©a ***")
        time.sleep(STARTUP_DELAY_AFTER_BACKUP)
    except FileNotFoundError:
        print(f"L·ªñI: Kh√¥ng t√¨m th·∫•y ƒë∆∞·ªùng d·∫´n ·ª©ng d·ª•ng Backup: {BACKUP_APP_PATH}")
        return
        
    print("\n[PH·∫¶N 3] B·∫Øt ƒë·∫ßu v√≤ng l·∫∑p ki·ªÉm tra ho·∫°t ƒë·ªông ƒêƒ©a...")
    start_time = time.time()
    
    while time.time() - start_time < MAX_WAIT_TIME_DISK_CHECK:
        disk_time = get_performance_counter_value(DISK_ACTIVITY_COUNTER)
        
        if disk_time is not None:
            print(f"-> % Disk Time hi·ªán t·∫°i: {disk_time:.2f}%")
            
            if disk_time < DISK_ACTIVITY_THRESHOLD:
                print(f"--- ƒêƒ®A ·ªîN ƒê·ªäNH ({disk_time:.2f} < {DISK_ACTIVITY_THRESHOLD}%) - X√ÅC NH·∫¨N BACKUP HO√ÄN T·∫§T ---")
                break
        else:
            print("-> KH√îNG L·∫§Y ƒê∆Ø·ª¢C gi√° tr·ªã Disk Time. Ch·ªù 15s...")

        print("Ch·ªù 15 gi√¢y...")
        time.sleep(15)

    else:
        print("\nC·∫¢NH B√ÅO: ƒê√£ h·∫øt th·ªùi gian ch·ªù t·ªëi ƒëa (1 gi·ªù).")

    # --- PH·∫¶N 3.5: CH·ªú V√Ä KI·ªÇM TRA L·∫†I ƒêƒ®A (Y√™u c·∫ßu m·ªõi) ---
    print("\n[PH·∫¶N 3.5] Ch·ªù 10 gi√¢y v√† ki·ªÉm tra ƒêƒ©a l·∫ßn cu·ªëi...")
    time.sleep(10) 

    # Th·ª±c hi·ªán ki·ªÉm tra ƒëƒ©a l·∫ßn cu·ªëi (Ch·ªâ m·ªôt l·∫ßn ki·ªÉm tra)
    disk_time = get_performance_counter_value(DISK_ACTIVITY_COUNTER)

    if disk_time is not None and disk_time < DISK_ACTIVITY_THRESHOLD:
        print(f"-> % Disk Time cu·ªëi c√πng: {disk_time:.2f}% (·ªîn ƒë·ªãnh).")
    elif disk_time is not None:
        print(f"-> % Disk Time cu·ªëi c√πng: {disk_time:.2f}% (V·∫´n cao). Ti·∫øp t·ª•c ƒë√≥ng ·ª©ng d·ª•ng.")
    else:
        print("-> Kh√¥ng l·∫•y ƒë∆∞·ª£c gi√° tr·ªã Disk Time l·∫ßn cu·ªëi. Ti·∫øp t·ª•c ƒë√≥ng ·ª©ng d·ª•ng.")
        
    # ƒê√≥ng ·ª©ng d·ª•ng Backup
    if backup_process and backup_process.poll() is None:
        print(f"ƒê√≥ng ·ª©ng d·ª•ng Backup: {BACKUP_APP_PATH}")
        backup_process.terminate() 
        time.sleep(1)
        if backup_process.poll() is None:
            backup_process.kill() 
            
    # --- PH·∫¶N 4: G·ªåI L·∫†I ·ª®NG D·ª§NG V√Ä CLICK CU·ªêI C√ôNG ---
    print("\n[PH·∫¶N 4] Ti·∫øp t·ª•c m·ªü LDMultiplayer v√† Click cu·ªëi c√πng (Kh·ªüi t·∫°o phi√™n m·ªõi)...")
    
    try:
        print(f"G·ªçi l·∫°i ·ª©ng d·ª•ng LDMultiplayer: {LDPLAYER_MULTIPLAYER_PATH}")
        subprocess.Popen(LDPLAYER_MULTIPLAYER_PATH)
        time.sleep(5) 
    except FileNotFoundError:
        print(f"L·ªñI: Kh√¥ng t√¨m th·∫•y ƒë∆∞·ªùng d·∫´n ·ª©ng d·ª•ng: {LDPLAYER_MULTIPLAYER_PATH}")
        return 

    # Click theo t·ªça ƒë·ªô m·ªõi (Kh·ªüi ch·∫°y) - ƒê√£ th√™m 1236, 272
    CLICK_SEQUENCE_FINAL = [(650, 749), (651, 380), (783, 749), (798, 656), (1236, 272)]
    for i, (x, y) in enumerate(CLICK_SEQUENCE_FINAL):
        print(f"Click kh·ªüi ch·∫°y {i+1}: ({x}, {y})")
        pyautogui.click(x, y)
        time.sleep(1) 

    print("\n[PH·∫¶N 4 K·∫æT TH√öC] ƒê√£ ho√†n th√†nh quy tr√¨nh LDPlayer.")


# ==============================================================================
# 4. CHU·ªñI H√ÄNH ƒê·ªòNG EMURB M·ªöI (D√πng PyAutoGUI - ƒê√£ c·∫≠p nh·∫≠t)
# ==============================================================================

def run_emurb_sequence():
    
    # 1. Ch·ªù countdown ban ƒë·∫ßu
    time.sleep(INITIAL_COUNTDOWN_SECONDS) 

    # 2. M·ªü EmuRB
    if not open_application(EMURB_PATH):
        return

    # 3. Ch·ªù 15s ·ª©ng d·ª•ng kh·ªüi ƒë·ªông
    time.sleep(15) 
    
    # Thao t√°c click ƒë·ªÉ focus (theo t·ªça ƒë·ªô m·ªõi b·∫°n cung c·∫•p)
    pyautogui.click(694, 61)
    time.sleep(2)
    pyautogui.press('enter')
    time.sleep(2)
    pyautogui.click(694, 91)
    time.sleep(2)
    
    # 4. G·ª≠i ph√≠m 3 
    pyautogui.press("3")
    time.sleep(2)
    
    # 5. G·ª≠i Enter 
    pyautogui.press('enter')
    
    # 6. Ch·ªù 30s
    time.sleep(30)

    # 7. G·ª≠i Enter
    pyautogui.press('enter')

    # 8. G·ª≠i ph√≠m 1
    pyautogui.press("1")
    time.sleep(2)
    
    # G·ª≠i Enter sau khi g·ª≠i ph√≠m 1
    pyautogui.press('enter') 
    time.sleep(5)
    
    # 9. Click chu·ªôt v√† ch·ªù (ƒê√£ chuy·ªÉn sang double click)
    
    # Double click (744, 699)
    pyautogui.click(744, 699)
    time.sleep(1)
    pyautogui.click(744, 699)
    time.sleep(2)
    
    pyautogui.click(1047, 542)
    time.sleep(30)
    
    # Double click (984, 542)
    pyautogui.click(984, 542)
    time.sleep(2)
    pyautogui.click(984, 542)
    time.sleep(2)
    
    # Double click (1288, 305)
    pyautogui.click(1288, 305)
    time.sleep(2)
    pyautogui.click(1288, 305)
    time.sleep(2)
    
    # 10. Click ƒë·ªÉ focus/ch·ªçn c·ª≠a s·ªï (l·∫ßn 2)
    pyautogui.click(694, 61)
    time.sleep(2)
    pyautogui.click(694, 61)
    time.sleep(2)

    # 11. G·ª≠i ph√≠m 2
    pyautogui.press("2")
    time.sleep(1)

    # 12. G·ª≠i Enter
    pyautogui.press('enter')

    print("\n[PH·∫¶N 5 K·∫æT TH√öC] Chu·ªói h√†nh ƒë·ªông EmuRB ƒë√£ ho√†n t·∫•t.")


# ==============================================================================
# MAIN EXECUTION
# ==============================================================================

if __name__ == "__main__":
    
    # Th·ª±c thi chu·ªói LDPlayer/Backup
    run_automation_sequence()
    
    # Th·ª±c thi chu·ªói EmuRB m·ªõi
    #run_emurb_sequence()
    
    print("\n[K·∫æT TH√öC] To√†n b·ªô quy tr√¨nh t·ª± ƒë·ªông h√≥a ƒë√£ ho√†n t·∫•t.")

